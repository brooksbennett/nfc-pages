<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ZEN32 – Scene Controller (Near Bedroom)</title>
  <style>
    :root{
      --bg:#0b0f14; --panel:#0f1620; --card:#11161d; --muted:#96a0ad; --text:#e6edf3; --accent:#60a5fa; --line:#1f2937;
      --bezel:#0a0f17; --bezelEdge:#0c111a; --screw:#2a3442; --shine:rgba(255,255,255,.04);
    }
    @media (prefers-color-scheme: light){:root{--bg:#eef2f7; --panel:#f7fafc; --card:#ffffff; --muted:#475569; --text:#0b1220; --accent:#0369a1; --line:#d8dee6; --bezel:#e6ebf2; --bezelEdge:#d8dee6; --screw:#b8c0cc; --shine:rgba(0,0,0,.05)}}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(160deg,var(--bg),#06080d 60%);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,sans-serif;line-height:1.45}
    .wrap{max-width:1120px;margin:0 auto;padding:28px}
    header{display:flex;gap:16px;align-items:end;justify-content:space-between;margin-bottom:18px}
    h1{font-size:clamp(22px,2.6vw,34px);margin:0}
    .sub{color:var(--muted);font-size:14px;margin-top:4px}
    .actions{display:flex;gap:10px;flex-wrap:wrap}
    button{background:transparent;color:var(--text);border:1px solid var(--line);border-radius:12px;padding:9px 14px;font-weight:600;cursor:pointer}
    button.primary{background:var(--panel)}
    button:focus{outline:2px solid var(--accent);outline-offset:2px}

    main{display:grid;grid-template-columns:380px 1fr;gap:24px}
    @media (max-width:980px){main{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.25);overflow:hidden}
    .card h2{font-size:18px;margin:0;padding:14px 16px;border-bottom:1px solid var(--line)}
    .card .content{padding:14px 16px}

    /* --- Realistic ZEN32 mock --- */
    .deviceWrap{display:flex;justify-content:center;padding:18px}
    .device{width:min(340px,86vw);aspect-ratio:2.1/4.1;background:var(--bezel);border:1px solid var(--bezelEdge);border-radius:22px;box-shadow:
      inset 0 1px 0 var(--shine),
      inset 0 -30px 60px rgba(0,0,0,.12),
      0 14px 40px rgba(0,0,0,.35);
      padding:20px;position:relative}
    .screw{position:absolute;width:16px;height:16px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#fff3,transparent 60%), var(--screw);box-shadow:inset 0 2px 3px rgba(0,0,0,.35)}
    .screw.top{top:10px;left:50%;transform:translateX(-50%)}
    .screw.bottom{bottom:10px;left:50%;transform:translateX(-50%)}

    .plate{display:grid;grid-template-rows:1fr 84px 84px;gap:12px;height:100%}
    .paddle{background:linear-gradient(180deg,#0003,#0000), var(--panel);border:1px solid var(--line);border-radius:14px;display:flex;align-items:center;justify-content:center;position:relative;cursor:pointer}
    .paddle .label{position:absolute;top:8px;left:10px;font-size:12px;color:var(--muted)}

    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .key{background:linear-gradient(180deg,#0002,#0000), var(--panel);border:1px solid var(--line);border-radius:14px;min-height:84px;display:flex;align-items:center;justify-content:center;position:relative;cursor:pointer}
    .key .label{position:absolute;top:8px;left:10px;font-size:12px;color:var(--muted)}
    .key .led{position:absolute;top:10px;right:10px;width:12px;height:12px;border-radius:50%;box-shadow:0 0 0 1px var(--line),0 0 10px currentColor}

    .active{outline:2px solid var(--accent);outline-offset:2px}

    /* Details side */
    .details{display:grid;gap:12px}
    .box{border:1px dashed var(--line);border-radius:12px;padding:12px}
    .box h3{margin:0 0 8px 0;font-size:15px}
    .kv{display:grid;grid-template-columns:170px 1fr;gap:6px 10px;font-size:14px}
    .kv div{padding:2px 0}
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{display:inline-flex;align-items:center;gap:6px;background:rgba(127,127,127,.08);border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:12px}
    code{background:rgba(127,127,127,.12);padding:2px 6px;border-radius:6px}
    .muted{color:var(--muted)}
    .list{display:grid;gap:8px}
    .list-item{border:1px solid var(--line);border-radius:10px;padding:10px}
    .list-item .t{font-weight:600;display:flex;align-items:center;gap:8px}
    .badge{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);border-radius:999px;padding:3px 8px;font-size:11px}
    .legend{font-size:12px;color:var(--muted)}
    .footer{margin-top:18px;font-size:12px;color:var(--muted)}

    .colorGrid{display:flex;flex-wrap:wrap;gap:8px}
    .swatch{display:flex;align-items:center;gap:8px;border:1px solid var(--line);border-radius:10px;padding:6px 10px;font-size:12px}
    .dot{width:12px;height:12px;border-radius:50%;box-shadow:0 0 0 1px var(--line),0 0 10px currentColor}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Scene Controller – Near Bedroom (ZEN32)</h1>
      </div>
      <div class="actions">
        <button id="printBtn" class="primary" title="Print or Save as PDF">Print / PDF</button>
        <button id="toggleLayout" title="Switch panel/list order">Toggle View</button>
      </div>
    </header>

    <main>
      <section class="card" aria-label="Switch layout">
        <h2>Switch Layout</h2>
        <div class="content deviceWrap">
          <div class="device">
            <div class="screw top" aria-hidden="true"></div>
            <div class="plate">
              <div class="paddle" data-key="0" tabindex="0" role="button" aria-label="Paddle / Main">
                <span class="label">Paddle / Main</span>
                ⎋
              </div>
              <div class="row">
                <div class="key" data-key="1" tabindex="0" role="button" aria-label="Key 1 – Master Bedroom Light">
                  <span class="label">Key 1</span>
                  ①
                  <span class="led" id="led-1" title="LED"></span>
                </div>
                <div class="key" data-key="2" tabindex="0" role="button" aria-label="Key 2 – Recessed Lights">
                  <span class="label">Key 2</span>
                  ②
                  <span class="led" id="led-2" title="LED"></span>
                </div>
              </div>
              <div class="row">
                <div class="key" data-key="3" tabindex="0" role="button" aria-label="Key 3 – Christmas Mode / Twinkle Tree">
                  <span class="label">Key 3</span>
                  ③
                  <span class="led" id="led-3" title="LED"></span>
                </div>
                <div class="key" data-key="4" tabindex="0" role="button" aria-label="Key 4 – Living Room Light / All Off Scene">
                  <span class="label">Key 4</span>
                  ④
                  <span class="led" id="led-4" title="LED"></span>
                </div>
              </div>
            </div>
            <div class="screw bottom" aria-hidden="true"></div>
          </div>
        </div>
      </section>

      <section class="card" id="detailsCard" aria-live="polite">
        <h2 id="detailsTitle">Details</h2>
        <div class="content details">
          <div class="box">
            <h3 id="boxTitle">Select a control to see its actions</h3>
            <div class="kv" id="kv">
              <div class="muted">Friendly name:</div>
              <div class="muted">—</div>
              <div class="muted">Entity tracking:</div>
              <div class="muted">—</div>
              <div class="muted">Primary (single‑tap):</div>
              <div class="muted">—</div>
              <div class="muted">Alternates:</div>
              <div class="muted">—</div>
              <div class="muted">LED behavior:</div>
              <div class="muted">—</div>
            </div>
          </div>

          <div class="box">
            <h3>LED Color Map (editable)</h3>
            <div id="colorGrid" class="colorGrid"></div>
            <div class="legend">These are typical ZEN32 colors. If your firmware maps numbers differently, tweak the <code>LED_MAP</code> at the top of the script.</div>
          </div>

          <div class="box">
            <h3>All Actions</h3>
            <div id="allList" class="list"></div>
          </div>

          <div class="footer">Source: Home Assistant automation <code>Scene Controller – Near Bedroom</code> with <code>rwalker777/ZEN32-control-track.yaml</code>.</div>
        </div>
      </section>
    </main>
  </div>

  <script>
  // --- Friendly names & gestures added ---
  // Gesture badges
  const BADGES = {
    single: '<span class="badge" title="Single tap">⭘ Single</span>',
    hold:   '<span class="badge" title="Hold">⧖ Hold</span>',
    double: '<span class="badge" title="Double tap">×2 Double</span>',
    alt:    '<span class="badge" title="Alt gesture">★ Alt</span>'
  };

  // LED map: common ZEN32 palette (adjust if needed)
  const LED_MAP = {
    1: {name:'Blue',   color:'#60a5fa'},
    2: {name:'Green',  color:'#22c55e'},
    3: {name:'Amber',  color:'#f59e0b'},
    4: {name:'Red',    color:'#ef4444'},
    5: {name:'Purple', color:'#a855f7'},
    6: {name:'Yellow', color:'#eab308'},
    7: {name:'Cyan',   color:'#38bdf8'}
  };

  const CONFIG = {
    alias: "Scene Controller - Near Bedroom",
    blueprint: "rwalker777/ZEN32-control-track.yaml",
    keys: {
      0: { name:"Paddle / Main", friendly:"Main Relay", tracks:"switch.living_room_lamp", actions:[], led:{} },
      1: { name:"Key 1", friendly:"Master Bedroom Light", tracks:"switch.master_bedroom_light", actions:[
            { type:"single", icon:"single", label:"Toggle Master Bedroom Light", domain:"switch", entity:"switch.master_bedroom_light" }
          ], led:{ off_color:"2", off_brightness:"2", on_brightness:"0" } },
      2: { name:"Key 2", friendly:"Recessed Lights", tracks:"light.living_room_recessed", actions:[
            { type:"single", icon:"single", label:"Turn ON Recessed Lights", domain:"light", entity:"light.living_room_recessed" },
            { type:"hold",   icon:"hold",   label:"Turn OFF Recessed Lights", domain:"light", entity:"light.living_room_recessed" }
          ], led:{} }, // scene_2h implies hold
      3: { name:"Key 3", friendly:"Christmas Mode / Twinkle Tree", tracks:"light.twinkle_tree", actions:[
            { type:"single", icon:"single", label:"Enable Christmas Mode", domain:"input_boolean", entity:"input_boolean.christmas", op:"turn_on" },
            { type:"double", icon:"double", label:"Disable Christmas Mode", domain:"input_boolean", entity:"input_boolean.christmas", op:"turn_off" }
          ], led:{ off_color:"4", off_brightness:"2", unavail_brightness:"2", on_color:"4" } },
      4: { name:"Key 4", friendly:"Living Room / All Off", tracks:"light.living_room_light", actions:[
            { type:"hold", icon:"hold", label:"All Off (LR Light, Fan, Zooz Switch)", batch:[
              { domain:"light", op:"turn_off", entity:"light.living_room_light" },
              { domain:"fan",  op:"turn_off", entity:"fan (…119b)" },
              { domain:"switch", op:"turn_off", entity:"switch (75327a… )" }
            ]}
          ], led:{ off_color:"5", off_brightness:"2", on_brightness:"0" } },
    }
  };

  function prettyEntity(e){
    if(!e) return "—";
    const parts = e.split(".");
    const id = parts[1]||e; 
    return id.replace(/_/g, " ").replace(/\b\w/g, c=>c.toUpperCase());
  }

  function badge(icon){ return BADGES[icon] || BADGES.alt; }

  function actionRow(a){
    if(a.batch){
      return `<div class="list-item"><div class="t">${badge(a.icon||'alt')}${a.label}</div>`+
             a.batch.map(x=>`<div class="muted">• ${x.op||'action'} <code>${x.domain}</code> → <code>${x.entity}</code></div>`).join("")+
             `</div>`;
    }
    const verb = a.op? a.op.replace("_"," ") : (a.label.toLowerCase().includes("toggle")? "toggle" : "execute");
    return `<div class="list-item"><div class="t">${badge(a.icon||a.type)}${a.label}</div><div class="muted">• ${verb} <code>${a.domain}</code> → <code>${a.entity||''}</code></div></div>`;
  }

  function ledChips(led){
    if(!led || Object.keys(led).length===0) return '<span class="muted">—</span>';
    const toChip = (k,v)=>{
      const n = Number(v); const m = LED_MAP[n];
      const sw = m? `<span class="dot" style="color:${m.color}"></span> <strong>${m.name}</strong> <code>${n}</code>` : `<code>${v}</code>`;
      return `<span class="chip">${k.replace('_',' ')}: ${sw}</span>`;
    };
    return '<div class="chips">'+Object.entries(led).map(([k,v])=>toChip(k,v)).join("")+'</div>';
  }

  function setActive(key){
    document.querySelectorAll('.key,.paddle').forEach(k=>k.classList.toggle('active', k.getAttribute('data-key')==key));

    const meta = CONFIG.keys[key];
    const title = key==0? 'Paddle / Main' : meta.name;
    document.getElementById('detailsTitle').textContent = `${title} – Details`;
    document.getElementById('boxTitle').textContent = meta.friendly || title;

    const primary = meta.actions.find(a=>a.type==='single');
    const alts = meta.actions.filter(a=>a.type!=='single');

    const kv = document.getElementById('kv');
    kv.innerHTML = ''+
      `<div>Friendly name:</div><div>${meta.friendly || '<span class="muted">—</span>'}</div>`+
      `<div>Entity tracking:</div><div><code>${meta.tracks||'—'}</code> (${prettyEntity(meta.tracks)})</div>`+
      `<div>Primary (single‑tap):</div><div>${primary? actionRow(primary): '<span class="muted">—</span>'}</div>`+
      `<div>Alternates:</div><div>${alts.length? alts.map(actionRow).join('') : '<span class="muted">—</span>'}</div>`+
      `<div>LED behavior:</div><div>${ledChips(meta.led)}</div>`;
  }

  function buildAllList(){
    const list = document.getElementById('allList');
    list.innerHTML = Object.entries(CONFIG.keys).map(([k,v])=>{
      const lines = [];
      if(v.actions.length===0){ lines.push('<div class="muted">(No scenes configured)</div>'); }
      v.actions.forEach(a=> lines.push(actionRow(a)) );
      return `<div class="list-item"><div class="t">${(k==0? 'Paddle / Main' : v.name)} <span class="muted">–</span> ${v.friendly || prettyEntity(v.tracks)}</div>${lines.join('')}</div>`;
    }).join('');
  }

  function updateLEDDots(){
    const m = CONFIG.keys;
    const setDot = (key, colorNum)=>{
      const dot = document.getElementById(`led-${key}`);
      if(!dot) return;
      if(!colorNum){ dot.style.visibility='hidden'; return; }
      const map = LED_MAP[Number(colorNum)];
      dot.style.visibility='visible';
      dot.style.color = (map && map.color) || '#60a5fa';
      dot.title = map? `${map.name} (${colorNum})` : `LED color ${colorNum}`;
    };
    setDot(1, (m[1].led.off_color||m[1].led.on_color));
    setDot(2, (m[2].led.off_color||m[2].led.on_color));
    setDot(3, (m[3].led.off_color||m[3].led.on_color));
    setDot(4, (m[4].led.off_color||m[4].led.on_color));
  }

  function buildColorGrid(){
    const host = document.getElementById('colorGrid');
    host.innerHTML = Object.entries(LED_MAP).map(([num,info])=>
      `<div class="swatch"><span class="dot" style="color:${info.color}"></span> <strong>${info.name}</strong> <code>${num}</code></div>`
    ).join('');
  }

  // Layout toggle (swap columns for narrow screens)
  document.getElementById('toggleLayout').addEventListener('click', ()=>{
    const main = document.querySelector('main');
    const current = getComputedStyle(main).gridTemplateColumns;
    main.style.gridTemplateColumns = current.startsWith('380px')? '1fr 380px' : '380px 1fr';
  });

  document.getElementById('printBtn').addEventListener('click', ()=>window.print());

  // Interactions
  document.querySelectorAll('[data-key]').forEach(el=>{
    el.addEventListener('click', ()=> setActive(el.getAttribute('data-key')));
    el.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); setActive(el.getAttribute('data-key')); }});
  });

  // Init
  buildAllList();
  updateLEDDots();
  buildColorGrid();
  setActive(1);
  </script>
</body>
</html>
